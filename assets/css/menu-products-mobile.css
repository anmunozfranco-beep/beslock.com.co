/* assets/css/menu-products-mobile.css
   Versión ajustada: Products panel desliza y hace scroll correctamente.
   Reemplaza completamente el archivo en wp-content/themes/beslock-custom/assets/css/
*/

/* Variables */
:root{
  --drawer-width: 320px;
  --drawer-bg: #ffffff;
  --products-panel-width: 100%; /* en móvil es 100%, en desktop puedes ajustarlo */
  --backdrop-color: rgba(0,0,0,0.45);
  --drawer-ease: cubic-bezier(.22,.9,.41,1);
  --drawer-duration: 360ms;
  --backdrop-duration: 240ms;

  /* Productos (panel interno) - control de animación separado */
  --products-duration: 300ms; /* tuned: snappy panel animation */
  --products-ease: cubic-bezier(.22,.9,.28,1); /* slightly snappy ease-out */
  --products-delay: 0ms; /* start immediately on click */
  --menu-link-color: #0b0b0b;
}

/* Drawer header (logo) shown at top of panel with translucent background */
.drawer-header {
  position: sticky;
  top: 0;
  z-index: 1320 !important;
  display: flex !important;
  align-items: center !important;
  justify-content: flex-start !important; /* keep close button on the left */
  position: relative !important;
  /* match main header spacing but cancel panel padding so it's flush to viewport top */
  padding: 0.4rem 0 !important; /* match .header__bar mobile */
  margin: -1.25rem -1.25rem 0 -1.25rem !important; /* cancel panel padding so header is anchored to top */
  background: rgba(255,255,255,0.85) !important; /* opacity layer */
  backdrop-filter: blur(6px) !important;
  -webkit-backdrop-filter: blur(6px) !important;
  box-shadow: 0 1px 0 rgba(0,0,0,0.04) inset !important;
}
.drawer-header .drawer__logo {
  position: absolute !important;
  left: 50% !important;
  transform: translateX(-50%) !important;
  z-index: 2 !important;
  display: flex !important;
  align-items: center !important;
}
.drawer-header .drawer__logo img {
  display: block !important;
  height: var(--site-logo-height, 32px) !important; /* match header logo size */
  width: auto !important;
}

/* Ensure drawer header remains visible when products panel open */
nav#mobileDrawer.products-open .drawer-header,
nav#mobileDrawer.is-open .drawer-header {
  display: flex !important;
}

/* Keep header visually above main menu even when main menu hidden for products */
nav#mobileDrawer.products-open .mobile-menu { visibility: hidden !important; }

/* Contenedor del drawer */
nav#mobileDrawer.mobile-drawer {
  position: fixed;
  inset: 0;
  display: block;
  z-index: 1200;
  pointer-events: none;
}

/* Backdrop */
nav#mobileDrawer .mobile-drawer__backdrop,
#drawerBackdrop {
  position: fixed !important;
  inset: 0 !important;
  background: rgba(0,0,0,0) !important;
  transition: background var(--backdrop-duration) ease !important;
  z-index: 1220 !important;
  pointer-events: none !important;
}

/* Panel principal del drawer (izquierda) */
nav#mobileDrawer .mobile-drawer__panel {
  position: fixed !important;
  top: 0 !important;
  left: 0 !important;
  height: 100vh !important;
  width: var(--drawer-width) !important;
  max-width: 85vw !important;
  background: var(--drawer-bg) !important;
  box-shadow: 10px 0 30px rgba(0,0,0,0.12) !important;
  transform: translate3d(-100%, 0, 0) !important;
  will-change: transform, opacity !important;
  transition: transform var(--drawer-duration) var(--drawer-ease) !important;
  z-index: 1301 !important;
  overflow: visible !important; 
  /* allow absolute children to overflow */
  -webkit-overflow-scrolling: touch !important;
  padding: 1.25rem 1.25rem 0.75rem 1.25rem !important;
  box-sizing: border-box !important;
  pointer-events: auto !important;
}

/* Drawer abierto */
nav#mobileDrawer.is-open { pointer-events: auto; }
nav#mobileDrawer.is-open .mobile-drawer__panel { transform: translate3d(0, 0, 0) !important; }
nav#mobileDrawer.is-open .mobile-drawer__backdrop,
#drawerBackdrop.backdrop-visible {
  background: var(--backdrop-color) !important;
  pointer-events: auto !important;
}

/* Menu principal: items */
/* Menu principal: items */
/* We make the menu a column flex container and give it 70vh so items
  distribute vertically filling ~70% of the viewport height. This
  places the last item near the 70% mark as requested. */
nav#mobileDrawer .mobile-menu { margin: 0; padding: 0; display: flex !important; flex-direction: column !important; justify-content: space-between !important; height: 70vh !important; box-sizing: border-box !important; }
nav#mobileDrawer .mobile-menu__item {
  list-style: none !important;
  margin: 0 !important;
  padding: 1.25rem 0 !important;
  border: none !important;
  background: transparent !important;
  position: relative !important;
}
nav#mobileDrawer .mobile-menu__item::after,
nav#mobileDrawer .mobile-menu__item::before {
  display: none !important;
  content: none !important;
}
nav#mobileDrawer .mobile-menu__item a,
nav#mobileDrawer .mobile-menu__link,
nav#mobileDrawer .mobile-menu__item .mobile-menu__link--plain {
  display: block !important;
  margin: 0 !important;
  padding: 0 !important;
  font-size: 1.2rem !important;
  line-height: 1.2 !important;
  color: var(--menu-link-color) !important;
  text-decoration: none !important;
  font-weight: 500 !important;
  border-bottom: none !important;
}

/* Layout for icon + title + subtitle rows (as in design screenshot) */
nav#mobileDrawer .mobile-menu__link {
  display: flex !important;
  align-items: flex-start !important; /* align icon with the top/title line */
  gap: 1rem !important;
  padding: 0.6rem 0.25rem !important;
  width: 100% !important;
  border-radius: 8px !important;
  transition: background-color 180ms ease, transform 120ms ease;
}

/* Icon styling: slightly larger, dark neutral color matching screenshot */
nav#mobileDrawer .mobile-menu__link i.bi {
  font-size: 1.7rem !important;
  line-height: 1 !important;
  color: #0b2b36 !important; /* dark navy-ish for icons */
  min-width: 38px !important;
  text-align: center !important;
  pointer-events: none !important; /* decorative icon shouldn't intercept taps */
}

/* Force icon to align with the top of the text block (higher specificity) */
nav#mobileDrawer .mobile-menu__link > i.bi,
nav#mobileDrawer .mobile-menu__item > a.mobile-menu__link > i.bi,
nav#mobileDrawer .mobile-menu__item > button.mobile-menu__link > i.bi {
  align-self: flex-start !important;
  display: inline-block !important;
  margin-top: 0.18rem !important; /* small visual nudge */
}

/* Legacy safety: if any other rule forces centering via line-height/vertical-align, unset it */
nav#mobileDrawer .mobile-menu__link i.bi { vertical-align: top !important; }

/* Ensure non-Products rows align icon/text to top even if another rule applies
   Products (#productsToggle) keeps its centered behavior. This selector is
   specific and uses :not(#productsToggle) to avoid affecting Products. */
nav#mobileDrawer .mobile-menu__item > a.mobile-menu__link:not(#productsToggle),
nav#mobileDrawer .mobile-menu__item > button.mobile-menu__link:not(#productsToggle) {
  display: flex !important;
  align-items: flex-start !important;
}
nav#mobileDrawer .mobile-menu__item > a.mobile-menu__link:not(#productsToggle) > i.bi,
nav#mobileDrawer .mobile-menu__item > button.mobile-menu__link:not(#productsToggle) > i.bi {
  align-self: flex-start !important;
  margin-top: 0.18rem !important;
}

nav#mobileDrawer .mobile-menu__content {
  display: flex !important;
  flex-direction: column !important;
  align-items: flex-start !important;
}

.mobile-menu__title {
  font-size: 1.08rem !important;
  font-weight: 700 !important;
  color: #0b2b36 !important; /* stronger dark for title */
  line-height: 1.05 !important;
}

.mobile-menu__subtitle {
  font-size: 0.95rem !important;
  font-weight: 400 !important;
  color: #6f7d87 !important; /* muted blue/grey for subtitle */
  margin-top: 0.14rem !important;
  opacity: 0.95 !important;
}

/* subtle divider between rows to match capture spacing */
nav#mobileDrawer .mobile-menu__item { padding: 0.45rem 0 !important; }
nav#mobileDrawer .mobile-menu__item + .mobile-menu__item { border-top: 1px solid rgba(11,43,54,0.04) !important; }

/* Hover / Active interactions */
@media (pointer: fine) {
  nav#mobileDrawer .mobile-menu__link:hover {
    background: rgba(11,43,54,0.04) !important; /* soft navy tint */
    transform: translateY(-1px) !important;
  }
}
nav#mobileDrawer .mobile-menu__link:active {
  background: rgba(11,43,54,0.06) !important;
  transform: scale(0.998) !important;
}

/* Small adjustment for chevron / products row (keep original spacing) */
nav#mobileDrawer #productsToggle .chev,
nav#mobileDrawer .products-chevron { margin-left: 0.45rem !important; }

/* Products row: keep chevron next to the word 'Products' (not pushed to far right) */
nav#mobileDrawer .mobile-menu__item .mobile-menu__link--has-chevron,
nav#mobileDrawer #productsToggle {
  display: inline-flex !important;
  align-items: center !important; /* keep Products centered vertically */
  justify-content: flex-start !important;
  gap: 0.45rem !important;
  padding-right: 0.25rem !important;
}

/* Remove any background/rounded box on the Products toggle so it appears as plain text. */
nav#mobileDrawer #productsToggle,
nav#mobileDrawer button#productsToggle,
nav#mobileDrawer .mobile-menu__item > button#productsToggle.mobile-menu__link {
  background: transparent !important;
  border-radius: 0 !important;
  box-shadow: none !important;
  padding: 0.6rem 0 !important;
  margin: 0 !important;
  color: var(--menu-link-color) !important;
}

/* Target the dedicated modifier class for the Products toggle (BEM).
   This prevents global button styles from affecting this control. */
nav#mobileDrawer .mobile-menu__link--products,
nav#mobileDrawer .mobile-menu__link--products:hover,
nav#mobileDrawer .mobile-menu__link--products:active,
nav#mobileDrawer .mobile-menu__link--products:focus,
nav#mobileDrawer .mobile-menu__link--products:focus-visible {
  background: transparent !important;
  border: none !important;
  box-shadow: none !important;
  outline: none !important;
}

/* Ensure pseudo-elements don't draw boxes either */
nav#mobileDrawer .mobile-menu__link--products::before,
nav#mobileDrawer .mobile-menu__link--products::after {
  content: none !important;
  background: transparent !important;
}

/* Strong override: remove any focus/hover/active background or border applied by theme
   (covers pseudo-elements and accessibility :focus-visible). */
nav#mobileDrawer .mobile-menu__item > button#productsToggle.mobile-menu__link,
nav#mobileDrawer button#productsToggle,
nav#mobileDrawer #productsToggle,
nav#mobileDrawer #productsToggle::before,
nav#mobileDrawer #productsToggle::after,
nav#mobileDrawer button#productsToggle::before,
nav#mobileDrawer button#productsToggle::after {
  background: transparent !important;
  background-image: none !important;
  border: none !important;
  box-shadow: none !important;
  outline: none !important;
}

nav#mobileDrawer .mobile-menu__item > button#productsToggle.mobile-menu__link:focus,
nav#mobileDrawer button#productsToggle:focus,
nav#mobileDrawer #productsToggle:focus,
nav#mobileDrawer .mobile-menu__item > button#productsToggle.mobile-menu__link:active,
nav#mobileDrawer button#productsToggle:active,
nav#mobileDrawer #productsToggle:active,
nav#mobileDrawer .mobile-menu__item > button#productsToggle.mobile-menu__link:hover,
nav#mobileDrawer button#productsToggle:hover,
nav#mobileDrawer #productsToggle:hover {
  background: transparent !important;
  border: none !important;
  box-shadow: none !important;
  outline: none !important;
}

/* If keyboard focus styles are added via :focus-visible, remove them for this control */
nav#mobileDrawer .mobile-menu__item > button#productsToggle.mobile-menu__link:focus-visible,
nav#mobileDrawer button#productsToggle:focus-visible,
nav#mobileDrawer #productsToggle:focus-visible {
  outline: none !important;
  box-shadow: none !important;
}

/* Products chevron (controlado por JS) */
nav#mobileDrawer .products-chevron {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  margin-left: 0.45rem;
  font-size: 1.05rem;
  color: var(--menu-link-color);
  line-height: 1;
}
nav#mobileDrawer .products-chevron.hidden { display: none !important; }

/* Forzar ocultar pseudo indicators del theme */
#productsToggle::after,
nav#mobileDrawer .mobile-menu__item .mobile-menu__link--has-chevron::after,
nav#mobileDrawer .mobile-menu__item a#productsToggle::after {
  display: none !important;
  content: none !important;
}

/* Close/back button */
nav#mobileDrawer .mobile-drawer__close,
nav#mobileDrawer #closeDrawer,
.mobile-drawer__close {
  background: transparent !important;
  border: 0 !important;
  box-shadow: none !important;
  padding: 0.35rem !important;
  width: 44px !important;
  height: 44px !important;
  display: inline-flex !important;
  align-items: center !important;
  justify-content: center !important;
  border-radius: 999px !important;
  color: var(--menu-link-color) !important;
  cursor: pointer !important;
  position: relative !important; /* keep in flow at left */
  z-index: 3 !important;
  margin-left: 0.25rem !important;
}
nav#mobileDrawer .mobile-drawer__close .bi,
nav#mobileDrawer #closeDrawer .bi { font-size: 1.1rem !important; line-height: 1 !important; }

/* ----------------------------
   Products panel (sliding layer inside the drawer)
   - Height full, positioned absolute inside drawer panel
   - scroll enabled and smooth touch scrolling
   - transition on transform + opacity for visible animation
   ---------------------------- */
nav#mobileDrawer .mobile-products-panel {
  position: absolute !important;
  top: 0 !important;
  right: 0 !important;
  bottom: 0 !important;
  width: var(--products-panel-width) !important;
  height: 100vh !important;
  background: var(--drawer-bg) !important;
  z-index: 1310 !important; /* above drawer content */
  box-shadow: none !important;
  transform: translate3d(100%, 0, 0) !important; /* off-screen to the right */
  opacity: 0 !important;
  transition: transform var(--products-duration) var(--products-ease) var(--products-delay), opacity calc(var(--products-duration)/1.05) ease var(--products-delay) !important;
  padding: 1.25rem 1.25rem 10rem !important;
  box-sizing: border-box !important;
  overflow-y: auto !important;
  -webkit-overflow-scrolling: touch !important;
  pointer-events: none !important; /* disabled until visible */
}

/* If `hidden` attribute is applied prematurely, force it to remain visually present
   so CSS transitions (transform/opacity) still run. The JS will set `.models--hidden`
   and we rely on that class for the visual hide animation; this selector prevents
   the UA `display:none` from cutting the animation short. */
nav#mobileDrawer .mobile-products-panel[hidden] {
  display: block !important;
  visibility: visible !important;
  pointer-events: none !important;
  /* keep same transform/opacity rules as hidden state so the visual transition runs */
  transform: translate3d(100%, 0, 0) !important;
  opacity: 0 !important;
}

/* Be explicit for the class-driven hidden state as well (covers both attribute and class paths) */
nav#mobileDrawer .mobile-products-panel.models--hidden,
nav#mobileDrawer .mobile-products-panel.models--hidden[hidden] {
  transform: translate3d(100%, 0, 0) !important;
  opacity: 0 !important;
  pointer-events: none !important;
}

/* Visible state: slide in and allow interaction */
nav#mobileDrawer.products-open .mobile-products-panel,
nav#mobileDrawer .mobile-products-panel.models--visible {
  transform: translate3d(0, 0, 0) !important;
  opacity: 1 !important;
  pointer-events: auto !important;
}

/* Ensure that when we add the hidden class the hidden transform/opacity
   wins even if the parent has `products-open`. This gives JS the ability
   to keep `products-open` for other layout reasons while the panel itself
   animates out. */
nav#mobileDrawer.products-open .mobile-products-panel.models--hidden {
  transform: translate3d(100%, 0, 0) !important;
  opacity: 0 !important;
  pointer-events: none !important;
}

/* While products panel open, hide main menu visually but keep DOM for a11y */
nav#mobileDrawer.products-open .mobile-menu {
  visibility: hidden !important;
  pointer-events: none !important;
}

/* Keep close/back button visible when products-open */
nav#mobileDrawer.products-open .mobile-drawer__close {
  visibility: visible !important;
  pointer-events: auto !important;
}

/* Prevent body scroll when drawer open */
html.has-drawer-open { overflow: hidden !important; touch-action: none !important; }

/* Touch-only aggressive focus removal */
@media (pointer: coarse) and (hover: none) {
  nav#mobileDrawer .mobile-menu__item a,
  nav#mobileDrawer .mobile-menu__item button,
  nav#mobileDrawer .mobile-menu__link,
  #productsToggle,
  button#productsToggle {
    outline: none !important;
    box-shadow: none !important;
    border: none !important;
    background: transparent !important;
    -webkit-tap-highlight-color: transparent !important;
    caret-color: transparent !important;
  }
  nav#mobileDrawer .mobile-menu__item a:focus,
  nav#mobileDrawer .mobile-menu__item button:focus,
  #productsToggle:focus,
  button#productsToggle:focus {
    outline: none !important;
    box-shadow: none !important;
  }
}

/* Keep drawer header spacing consistent with main header on larger screens */
@media (min-width: 600px) {
  .drawer-header { padding: 0.7rem 0 !important; }
  .drawer-header .drawer__logo img { height: var(--site-logo-height, 38px) !important; }
}

/* Full-width ONLY in small screens (<=768px) */
@media (max-width: 768px) {
  nav#mobileDrawer .mobile-drawer__panel {
    left: 0 !important;
    right: 0 !important;
    width: 100vw !important;
    max-width: 100vw !important;
    box-shadow: none !important;
  }
  /* Products panel full width inside drawer in mobile */
  nav#mobileDrawer .mobile-products-panel {
    width: 100% !important;
    right: 0 !important;
  }
}

/* Utility */
.u-visually-hidden {
  position: absolute !important;
  width: 1px; height: 1px;
  padding: 0; margin: -1px;
  overflow: hidden; clip: rect(0 0 0 0); white-space: nowrap; border: 0;
}